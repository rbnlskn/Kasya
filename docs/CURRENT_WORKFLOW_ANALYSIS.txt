CURRENT WORKFLOW ANALYSIS

This document outlines the usage of scripts, GitHub actions, and agent workflows as they currently exist in the codebase.

1. ISSUE INITIATION (GITHUB)
--------------------------------------------------
Start: 
You create an Issue with label "ready".

Automation: 
The "issue-lifecycle.yml" workflow triggers.
- If the title has "[BATCH]", it generates context from referenced sub-issues (e.g., #123).
- Automatically assigns the issue to the actor (Agent/User) who labeled it "ready".

Planning Phase:
- Signal: Agent comments "Working on this".
- Status Change: GitHub Action removes "ready"/"backlog" and adds "planning" + "antigravity".
- Proposal: Agent posts an Implementation Plan.
- Approval: User comments "Approved" or "LGTM".
- Execution: GitHub Action removes "planning" and adds "in progress".


2. LOCAL DEVELOPMENT & VERSIONING
--------------------------------------------------
Branching: 
git checkout -b feature/issue-123

Versioning:
- New Feature: Run "npm run bump:minor" (Increments the second number Y, resets third number Z to 0 of package.json, src/constants.ts, and android versionName).
- Ongoing: Run "npm run bump:patch" (Increments the third number Z).
  (Note: The current script skips patch bumps if on "main", but enforces them otherwise.)

Coding: 
Run "npm run dev".


3. MOBILE & VERIFICATION
--------------------------------------------------
Sync: 
Run "npx cap sync" (Copy web assets to Android container).

Run: 
Run "npx cap open android" (Opens Android Studio).

Workflow:
- Build APK in Android Studio (Build > Build Bundle(s) / APK(s) > Build APK).
- Test on Emulator or Physical Device.
- Helper documentation exists in ".agent/workflows/build_apk.md".


4. REVIEW & MERGE
--------------------------------------------------
PR Creation:
Command: "/push_and_build" (Agent Workflow).
Steps:
1. npm run type-check
2. git commit & push
3. npm run build (Builds "dist" folder)
4. npx cap sync & open android
5. gh pr create --web

CI Checks:
Runs on Pull Request to "main".
Steps: npm ci, npm run type-check, npx playwright install, npm test.

PR Automation:
- Adds label "in review" to the PR and linked issues.
- Removes "in progress".

Merge:
Command: "/merge_and_close" (Agent Workflow).
Steps:
1. Verifies approval.
2. gh pr merge --squash --delete-branch.
3. Switch to "main" & git pull.
Closure: Merging the PR triggers "issue-lifecycle.yml" to close the linked issues and remove status labels.
